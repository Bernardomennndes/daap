# =========================================
# DAAP - Environment Configuration Example
# =========================================
# Copy this file to .env and adjust values as needed

ENV=dev
TZ=America/Sao_Paulo

# =========================================
# SCALING CONFIGURATION
# =========================================
# Number of reviews-service instances to run
REVIEWS_INSTANCES=3

# =========================================
# SERVICE PORTS
# =========================================
REVIEWS_SERVICE_PORT=3001
CACHE_SERVICE_PORT=3002
SEARCH_SERVICE_PORT=3003
WEB_PORT=3000

# =========================================
# INTERNAL SERVICE URLS (Docker Network)
# =========================================
# URLs for services to communicate within Docker network
REVIEWS_SERVICE_URL=http://reviews-service:3001
CACHE_SERVICE_URL=http://cache-service:3002
SEARCH_SERVICE_URL=http://search-service:3003

# =========================================
# EXTERNAL URLS (Traefik Routing)
# =========================================
# URLs accessible from outside the Docker network
REVIEWS_EXTERNAL_URL=http://reviews.localhost
CACHE_EXTERNAL_URL=http://cache.localhost
SEARCH_EXTERNAL_URL=http://search.localhost
WEB_EXTERNAL_URL=http://daap.localhost

# =========================================
# TRAEFIK CONFIGURATION
# =========================================
TRAEFIK_DASHBOARD_PORT=8080
TRAEFIK_WEB_PORT=80
TRAEFIK_WEBSECURE_PORT=443

# =========================================
# DATABASE CONFIGURATION
# =========================================
# MongoDB configuration for containerized environment
MONGO_URI=mongodb://admin:admin@mongodb:27017/daap?authSource=admin
MONGO_INITDB_ROOT_USERNAME=admin
MONGO_INITDB_ROOT_PASSWORD=admin
MONGO_HOST=mongodb
MONGO_PORT=27017
MONGO_DATABASE=daap
MONGO_EXPRESS_URL=http://0.0.0.0:8082

# =========================================
# CACHE CONFIGURATION
# =========================================
CACHE_ADAPTER=redis
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_URL=redis://redis:6379
DRAGONFLY_HOST=dragonfly
DRAGONFLY_PORT=6379

# Redis Commander (Web UI for Redis monitoring)
REDIS_HOSTS=local:redis:6379
REDIS_COMMANDER_URL=http://0.0.0.0:8081

# =========================================
# CACHE EVICTION STRATEGY CONFIGURATION
# =========================================
# Eviction strategy: lfu, lru, or hybrid
# - lfu: Least Frequently Used (removes entries with lowest access frequency)
# - lru: Least Recently Used (removes entries with oldest access time)
# - hybrid: Combines both frequency and recency with configurable weights
EVICTION_STRATEGY=lfu

# Maximum number of cache entries before eviction starts
EVICTION_MAX_ENTRIES=1000

# Number of entries to evict in each batch when limit is exceeded
EVICTION_BATCH_SIZE=50

# Hybrid strategy weights (only used when EVICTION_STRATEGY=hybrid)
# Values should sum to 1.0 for best results
# Default: 60% frequency, 40% recency
EVICTION_FREQUENCY_WEIGHT=0.6
EVICTION_RECENCY_WEIGHT=0.4

# =========================================
# CACHE OPTIMIZATION: FUZZY MATCHING
# =========================================
# Enable fuzzy matching for similar queries (partial keyword overlap)
# When enabled, if exact match fails, searches for queries with similar keywords
ENABLE_FUZZY_CACHE=true

# Minimum similarity threshold for fuzzy matches (0.0 to 1.0)
# 0.7 = requires 70% of keywords in common (Jaccard similarity)
# Higher values = stricter matching, lower false positives
# Lower values = more matches, higher false positives
FUZZY_SIMILARITY_THRESHOLD=0.7

# Maximum number of candidate keys to evaluate for fuzzy matching
# Lower values = faster but may miss best match
# Higher values = more thorough but slower
FUZZY_MAX_CANDIDATES=10

# =========================================
# AUTHENTICATION
# =========================================
# JWT Secret key - CHANGE THIS IN PRODUCTION!
SECRET_JWT=ca6d0e6f-ece4-43d8-bbda-71e873633a07

# =========================================
# MONITORING & OBSERVABILITY
# =========================================
# ELK Stack
ELK_URL=http://0.0.0.0:9200/

# Jaeger Tracing (fixed typo from "Jeager")
JAEGER_URL=http://0.0.0.0:16686/search
COLLECTOR_ZIPKIN_HTTP_PORT=9411

# Kibana
KIBANA_URL=http://0.0.0.0:5601/app/home

# Prometheus - Metrics Collection
PROMETHEUS_PORT=9090
PROMETHEUS_RETENTION=15d
METRICS_PORT=9464

# Grafana - Metrics Visualization
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_ROOT_URL=http://localhost:3000
GRAFANA_INSTALL_PLUGINS=

# InfluxDB - Time Series Database (k6 metrics)
INFLUXDB_PORT=8086
INFLUXDB_ADMIN_USER=admin
INFLUXDB_ADMIN_PASSWORD=adminadmin
INFLUXDB_ORG=daap
INFLUXDB_BUCKET=k6
INFLUXDB_ADMIN_TOKEN=daap-k6-secret-token

# =========================================
# OPENTELEMETRY CONFIGURATION
# =========================================
# OpenTelemetry Exporter endpoint (Jaeger OTLP receiver)
OTEL_EXPORTER_OTLP_ENDPOINT=http://jaeger:4317

# Trace sampling strategy
# Options: always_on, always_off, traceidratio, parentbased_always_on
# - always_on: Collect 100% of traces (development/testing)
# - traceidratio: Sample percentage of traces (set OTEL_TRACES_SAMPLER_ARG)
# - parentbased_always_on: Follow parent span sampling decision
OTEL_TRACES_SAMPLER=always_on

# Sampling ratio for traceidratio strategy (0.0 to 1.0)
# Example: 0.1 = 10% sampling, 1.0 = 100% sampling
OTEL_TRACES_SAMPLER_ARG=1.0

# Log level for OpenTelemetry SDK
# Options: debug, info, warn, error
OTEL_LOG_LEVEL=info

# Node environment (used by telemetry resource attributes)
NODE_ENV=development

# =========================================
# EXTERNAL APIS
# =========================================
GITHUB_SCRAP_API=https://legend-of-github-api.herokuapp.com

# =========================================
# DEVELOPMENT CONFIGURATION
# =========================================
# Enable debug mode
DEBUG=true

# Log levels: error, warn, info, debug
LOG_LEVEL=info

# Health check configuration
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10

# Load balancer configuration
LB_ALGORITHM=round_robin
LB_STICKY_SESSIONS=false

# =========================================
# PRODUCTION OVERRIDES
# =========================================
# Uncomment and modify for production use:

# ENV=production
# DEBUG=false
# LOG_LEVEL=warn
# SECRET_JWT=your-super-secure-jwt-secret-here
# MONGO_INITDB_ROOT_PASSWORD=your-secure-mongo-password
# TRAEFIK_WEBSECURE_PORT=443
# SSL_CERT_EMAIL=your-email@domain.com